{
  "vulnerable": {
    "idx": 212407,
    "project": "varnish-cache",
    "commit_id": "c5fd097e5cce8b461c6443af02b3448baef2491d",
    "commit_url": "https://github.com/varnishcache/varnish-cache/commit/c5fd097e5cce8b461c6443af02b3448baef2491d",
    "commit_message": "Do not call http_hdr_flags() on pseudo-headers\n\nIn http_EstimateWS(), all headers are passed to the http_isfiltered()\nfunction to calculate how many bytes is needed to serialize the entire\nstruct http. http_isfiltered() will check the headers for whether they are\ngoing to be filtered out later and if so skip them.\n\nHowever http_isfiltered() would attempt to treat all elements of struct\nhttp as regular headers with an implicit structure. That does not hold for\nthe first three pseudo-header entries, which would lead to asserts in\nlater steps.\n\nThis patch skips the filter step for pseudo-headers.\n\nFixes: #3830",
    "cve": "CVE-2022-38150",
    "cve_desc": "In Varnish Cache 7.0.0, 7.0.1, 7.0.2, and 7.1.0, it is possible to cause the Varnish Server to assert and automatically restart through forged HTTP/1 backend responses. An attack uses a crafted reason phrase of the backend response status line. This is fixed in 7.0.3 and 7.1.1.",
    "cwe": [
      "CWE-703"
    ],
    "nvd_url": "https://nvd.nist.gov/vuln/detail/CVE-2022-38150",
    "file_name": "cache_http.c",
    "func_hash": 811300647438513744666233377828733318,
    "file_hash": 145239057408586301398711991484884532857
  },
  "fixed": {
    "idx": 459029,
    "func_hash": 214500471714364858208416051205285025611,
    "file_hash": 148461925742958572930249757440638720534
  }
}